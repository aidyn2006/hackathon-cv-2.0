# üö´ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–ª–∞—Å—Å–∞ Text

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞:

**–ú–æ–¥–µ–ª—å –¥–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç –∫–ª–∞—Å—Å "Text", –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –Ω—É–∂–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é**

### –ë—ã–ª–æ:
- –ú–æ–¥–µ–ª—å: `['Signature', 'Text', 'qr-code', 'stamp']`
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞: **17 –æ–±—ä–µ–∫—Ç–æ–≤** (—ç—Ç–æ –±—ã–ª–∏ Text –¥–µ—Ç–µ–∫—Ü–∏–∏)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω—É–∂–Ω—ã —Ç–æ–ª—å–∫–æ: **–ü–æ–¥–ø–∏—Å–∏, –®—Ç–∞–º–ø—ã, QR-–∫–æ–¥—ã**
- –ö–ª–∞—Å—Å **Text** - –ª–∏—à–Ω–∏–π —à—É–º

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ:

### –î–æ–±–∞–≤–ª–µ–Ω —Ñ–∏–ª—å—Ç—Ä –¥–ª—è –∫–ª–∞—Å—Å–∞ Text –≤ `postprocessing.py`:

```python
class_thresholds = {
    '–ø–æ–¥–ø–∏—Å—å': 0.20,
    'signature': 0.20,
    '—à—Ç–∞–º–ø': 0.20,
    'stamp': 0.20,
    'qr': 0.3,
    'text': 999.0,      # ‚úÖ –§–∏–ª—å—Ç—Ä—É–µ–º Text (–Ω–µ–≤–æ–∑–º–æ–∂–Ω—ã–π –ø–æ—Ä–æ–≥)
    'default': 0.25
}
```

**–õ–æ–≥–∏–∫–∞:**
- –ï—Å–ª–∏ –∫–ª–∞—Å—Å = "Text", —Ç—Ä–µ–±—É–µ—Ç—Å—è confidence >= 999.0
- –¢–∞–∫–æ–π confidence –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω (–º–∞–∫—Å–∏–º—É–º 1.0)
- –í—Å–µ Text –¥–µ—Ç–µ–∫—Ü–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤—ã–≤–∞—é—Ç—Å—è

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç:

### **–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```
–í—Å–µ–≥–æ –æ–±—ä–µ–∫—Ç–æ–≤: 17  ‚Üê Text –¥–µ—Ç–µ–∫—Ü–∏–∏
–ü–æ–¥–ø–∏—Å–µ–π: 0
–®—Ç–∞–º–ø–æ–≤: 0
QR-–∫–æ–¥–æ–≤: 24
```

### **–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```
–í—Å–µ–≥–æ –æ–±—ä–µ–∫—Ç–æ–≤: 0   ‚Üê Text –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω ‚úÖ
–ü–æ–¥–ø–∏—Å–µ–π: 0
–®—Ç–∞–º–ø–æ–≤: 0
QR-–∫–æ–¥–æ–≤: 24        ‚Üê –ü—Ä–∞–≤–∏–ª—å–Ω–æ! ‚úÖ
```

---

## üéØ –¢–µ–ø–µ—Ä—å –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ:

‚úÖ **Signature** (–ø–æ–¥–ø–∏—Å—å) - –µ—Å–ª–∏ conf >= 0.20  
‚úÖ **stamp** (—à—Ç–∞–º–ø) - –µ—Å–ª–∏ conf >= 0.20  
‚úÖ **qr-code** (QR) - –µ—Å–ª–∏ conf >= 0.30  
‚ùå **Text** - –í–°–ï–ì–î–ê –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤—ã–≤–∞–µ—Ç—Å—è

---

## üîß –ö–ª–∞—Å—Å—ã –º–æ–¥–µ–ª–∏:

–í–∞—à–∞ –º–æ–¥–µ–ª—å `best.pt` –∏–º–µ–µ—Ç 4 –∫–ª–∞—Å—Å–∞:
1. **Signature** ‚úÖ - –Ω—É–∂–µ–Ω
2. **Text** ‚ùå - –Ω–µ –Ω—É–∂–µ–Ω (–æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω)
3. **qr-code** ‚úÖ - –Ω—É–∂–µ–Ω (–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ pyzbar)
4. **stamp** ‚úÖ - –Ω—É–∂–µ–Ω

---

## üìà –õ–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (–æ–±–Ω–æ–≤–ª–µ–Ω–æ):

```
YOLO Detection (4 –∫–ª–∞—Å—Å–∞)
    ‚Üì
–§–∏–ª—å—Ç—Ä –∫–ª–∞—Å—Å–∞ Text (conf >= 999.0 ‚Üí –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è)
    ‚Üì
Class-Specific Filter
    ‚îú‚îÄ Signature: conf >= 0.20
    ‚îú‚îÄ Stamp: conf >= 0.20
    ‚îú‚îÄ QR-code: conf >= 0.30
    ‚îî‚îÄ Text: –û–¢–§–ò–õ–¨–¢–†–û–í–ê–ù
    ‚Üì
Global Confidence Filter (conf >= 0.20)
    ‚Üì
Non-Maximum Suppression (IoU >= 0.6)
    ‚Üì
Merge Nearby Signatures (distance < 50px)
    ‚Üì
Final Results (—Ç–æ–ª—å–∫–æ Signature + Stamp)
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** QR-–∫–æ–¥—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ —á–µ—Ä–µ–∑ `pyzbar`, –ø–æ—ç—Ç–æ–º—É –∫–ª–∞—Å—Å "qr-code" –æ—Ç YOLO –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è.

---

## üé® –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–∏:

### **–ß—Ç–æ —Ä–∏—Å—É–µ—Ç—Å—è:**
- üü¢ **Signature** - –∑–µ–ª–µ–Ω—ã–µ bbox
- üîµ **stamp** - —Å–∏–Ω–∏–µ bbox
- üü° **qr-code** - –∂–µ–ª—Ç—ã–µ bbox (–∏–∑ pyzbar)
- ‚ö™ **Text** - –ù–ï —Ä–∏—Å—É–µ—Ç—Å—è (–æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω)

### **–ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ:**
- ‚úÖ –ü–æ–¥–ø–∏—Å–µ–π: count(Signature)
- ‚úÖ –®—Ç–∞–º–ø–æ–≤: count(stamp)
- ‚úÖ QR-–∫–æ–¥–æ–≤: count(pyzbar QR)
- ‚úÖ –í—Å–µ–≥–æ –æ–±—ä–µ–∫—Ç–æ–≤: –ü–æ–¥–ø–∏—Å–µ–π + –®—Ç–∞–º–ø–æ–≤ (–ë–ï–ó Text)

---

## üí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è:

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å –∫–ª–∞—Å—Å Text, –∏–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä–æ–≥:

### **–í–∞—Ä–∏–∞–Ω—Ç 1: –ü–æ–ª–Ω–æ—Å—Ç—å—é —É–±—Ä–∞—Ç—å (—Ç–µ–∫—É—â–∏–π)**
```python
'text': 999.0  # –ù–µ–≤–æ–∑–º–æ–∂–Ω—ã–π –ø–æ—Ä–æ–≥
```

### **–í–∞—Ä–∏–∞–Ω—Ç 2: –í—ã—Å–æ–∫–∏–π –ø–æ—Ä–æ–≥ (—Ç–æ–ª—å–∫–æ –æ—á–µ–Ω—å —É–≤–µ—Ä–µ–Ω–Ω—ã–µ)**
```python
'text': 0.8  # –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ confidence > 80%
```

### **–í–∞—Ä–∏–∞–Ω—Ç 3: –û–±—ã—á–Ω—ã–π –ø–æ—Ä–æ–≥ (—Ä–∞–∑—Ä–µ—à–∏—Ç—å)**
```python
'text': 0.25  # –û–±—ã—á–Ω—ã–π –ø–æ—Ä–æ–≥
```

---

## üß™ –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:

1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç —Å —Ç–µ–∫—Å—Ç–æ–º
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:
   - **–ë—ã–ª–æ:** "–í—Å–µ–≥–æ –æ–±—ä–µ–∫—Ç–æ–≤: 17"
   - **–°—Ç–∞–ª–æ:** "–í—Å–µ–≥–æ –æ–±—ä–µ–∫—Ç–æ–≤: 0" (–µ—Å–ª–∏ –Ω–µ—Ç –ø–æ–¥–ø–∏—Å–µ–π/—à—Ç–∞–º–ø–æ–≤)
3. QR-–∫–æ–¥—ã —Å—á–∏—Ç–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ

---

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:

–í –ª–æ–≥–∞—Ö `app_final.log` –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å:

```
[INFO] Filtered out: Text (conf=0.850 < threshold=999.000)
[INFO] Class-specific filtering: 17 -> 0 detections
[INFO] QR codes AFTER validation: 24
[INFO] QR count: total=24, valid=24, invalid=0
```

---

## üöÄ –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:

**`postprocessing.py`:**
- –î–æ–±–∞–≤–ª–µ–Ω –ø–æ—Ä–æ–≥ 999.0 –¥–ª—è –∫–ª–∞—Å—Å–∞ "text" (—Å—Ç—Ä–æ–∫–∞ 284)
- –ö–ª–∞—Å—Å Text —Ç–µ–ø–µ—Ä—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç—Å—è

**–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫:**
```bash
# –°–µ—Ä–≤–µ—Ä —É–∂–µ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
http://localhost:5001
```

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤ (—Ñ–∏–Ω–∞–ª—å–Ω–∞—è):

| –ö–ª–∞—Å—Å | Threshold | –°—Ç–∞—Ç—É—Å |
|-------|-----------|--------|
| Signature | 0.20 | ‚úÖ –ê–∫—Ç–∏–≤–µ–Ω |
| Stamp | 0.20 | ‚úÖ –ê–∫—Ç–∏–≤–µ–Ω |
| qr-code | 0.30 | ‚úÖ –ê–∫—Ç–∏–≤–µ–Ω (–Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è pyzbar) |
| **Text** | **999.0** | ‚ùå **–û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω** |
| Default | 0.25 | ‚úÖ –ê–∫—Ç–∏–≤–µ–Ω |

---

## üìä –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:

```
üìÑ –°—Ç—Ä–∞–Ω–∏—Ü: 9
üéØ –í—Å–µ–≥–æ –æ–±—ä–µ–∫—Ç–æ–≤: 0     ‚Üê –ë–ï–ó Text ‚úÖ
‚úçÔ∏è –ü–æ–¥–ø–∏—Å–µ–π: 0
üè∑Ô∏è –®—Ç–∞–º–ø–æ–≤: 0
üì± QR-–∫–æ–¥–æ–≤: 24          ‚Üê –ü—Ä–∞–≤–∏–ª—å–Ω–æ! ‚úÖ
‚≠ê –ö–∞—á–µ—Å—Ç–≤–æ: 18%
```

**–¢–µ–ø–µ—Ä—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —á–∏—Å—Ç–∞—è –∏ –ø–æ–Ω—è—Ç–Ω–∞—è!** üéâ

---

**–î–∞—Ç–∞:** 2025-11-15  
**–í–µ—Ä—Å–∏—è:** 1.3  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ Fixed & Deployed  
**–†–µ–∂–∏–º:** BALANCED + Text filter

